Доброе время суток!
Так как спешил, чтобы успеть закрыть спринт и проект(да и спринт с самим проектом тяжеловато давался) изначально запутался, но вроде бы похоже на правду, но не уверен)
По этой причине попытался разбить все формирования витрин на мелкие шаги, для меня так было проще, поэтому могут быть лишние вычисления.

Так же сразу небольшой вопрос:
Сначала пытался писать через SQLContext, но не всегда работало как хотелось, переписывая тоже самое на функции spark все отрабатывало нормально.
В чем может быть причина(если можно сказать на вскидку)?
Так как для меня проще пользоваться просто sql, а не писать функции spark.
Ну и какой подход больше приветсвуется и считается более правильным?

Исправил, то что было отмечено красным.
